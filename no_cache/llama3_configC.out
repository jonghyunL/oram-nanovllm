(py312) tdx@tdx-guest:~/llm_oram/nano-vllm$ python3 ttft_chunkprefill_emul.py llama3 2000
`torch_dtype` is deprecated! Use `dtype` instead!
128000
280147
128000
280147
0.6795367739996436 0.04043150899997272
1 0.24229512700003397 1.703100042504957e-05 0.24229512700003397
128000
280147
0.8298610519996146 0.03872856399993907
1 0.23724552000021504 1.4166000255499966e-05 0.23724552000021504
128000
280147
0.7448888890003218 0.03514616800021031
1 0.23170304900031624 1.2053000318701379e-05 0.23170304900031624
128000
280147
0.9287631690003764 0.04774925599940616
1 0.23282520599968848 1.9146999875374604e-05 0.23282520599968848
128000
280147
1.0219091259996276 0.048346337999646494
1 0.2321253539994359 3.852500049106311e-05 0.2321253539994359
5801 1
[0.04043150899997272, 0.03872856399993907, 0.03514616800021031, 0.04774925599940616, 0.048346337999646494]
[0.24229512700003397, 0.23724552000021504, 0.23170304900031624, 0.23282520599968848, 0.2321253539994359]
[0.01473844999964058, 0.013304437999977381, 0.013408527999672515, 0.013234319999355648, 0.013325834999704966]
0.6795367739996436 0.04249258149980051 0.23347478224991391 0.013318280249677628
(py312) tdx@tdx-guest:~/llm_oram/nano-vllm$ python3 ttft_chunkprefill_emul.py llama3 2000
`torch_dtype` is deprecated! Use `dtype` instead!
128000
280147
128000
280147
0.6644725730002392 0.04793274000076053
1 0.2354058939999959 1.667000015004305e-05 0.2354058939999959
128000
280147
0.8820968330001051 0.03584568400037824
1 0.2594815849997758 1.3621000107377768e-05 0.2594815849997758
128000
280147
0.8876414830001522 0.039812247000554635
1 0.23426138699960575 1.5517999599978793e-05 0.23426138699960575
128000
280147
0.9764818309995462 0.04948065099961241
1 0.23418326299997716 1.7026000023179222e-05 0.23418326299997716
128000
280147
1.0352339699993536 0.047782319000361895
1 0.23670296899945242 1.4512999769067392e-05 0.23670296899945242
5801 1
[0.04793274000076053, 0.03584568400037824, 0.039812247000554635, 0.04948065099961241, 0.047782319000361895]
[0.2354058939999959, 0.2594815849997758, 0.23426138699960575, 0.23418326299997716, 0.23670296899945242]
[0.014933335000023362, 0.013043384999946284, 0.01397109499976068, 0.013229692000095383, 0.013071641999886197]
0.6644725730002392 0.043230225250226795 0.24115730099970278 0.013328953499922136
(py312) tdx@tdx-guest:~/llm_oram/nano-vllm$ python3 ttft_chunkprefill_emul.py llama3 2500
`torch_dtype` is deprecated! Use `dtype` instead!
128000
280147
128000
280147
0.6545584469995447 0.06443244900037826
1 0.3216125680000914 1.3773999853583518e-05 0.3216125680000914
128000
280147
0.8182886539998435 0.05013835099998687
1 0.30559378400084825 1.6103000234579667e-05 0.30559378400084825
128000
280147
0.8239750009997806 0.05302015500001289
1 0.30686502600019594 1.2540999705379363e-05 0.30686502600019594
128000
280147
0.9128140660004647 0.051684774000023026
1 0.30597717000000557 1.3777999811281916e-05 0.30597717000000557
128000
280147
0.9920505749996664 0.06294865000018035
1 0.3019112390002192 1.226699987455504e-05 0.3019112390002192
7251.5 1
[0.06443244900037826, 0.05013835099998687, 0.05302015500001289, 0.051684774000023026, 0.06294865000018035]
[0.3216125680000914, 0.30559378400084825, 0.30686502600019594, 0.30597717000000557, 0.3019112390002192]
[0.014210915999683493, 0.014807377000579436, 0.013261600000078033, 0.01335851800013188, 0.01312047999999777]
0.6545584469995447 0.054447982500050784 0.30508680475031724 0.01363699375019678
(py312) tdx@tdx-guest:~/llm_oram/nano-vllm$ python3 ttft_chunkprefill_emul.py llama3 3000
`torch_dtype` is deprecated! Use `dtype` instead!
128000
280147
128000
280147
0.6433394669993504 0.06067461899965565
1 0.3921329130007507 1.4722000742040109e-05 0.3921329130007507
128000
280147
0.4464011509999182 0.04047230700052751
1 0.3723904420003237 9.198999578075018e-06 0.3723904420003237
128000
280147
0.5410661430005348 0.03879488899929129
1 0.3682239439995101 8.12700000096811e-06 0.3682239439995101
128000
280147
0.521403738999652 0.04306079799971485
1 0.3824545070001477 7.46000023355009e-06 0.3824545070001477
128000
280147
0.558171167999717 0.045559123999737494
1 0.3753566699997464 8.343000445165671e-06 0.3753566699997464
8698.75 1
[0.06067461899965565, 0.04047230700052751, 0.03879488899929129, 0.04306079799971485, 0.045559123999737494]
[0.3921329130007507, 0.3723904420003237, 0.3682239439995101, 0.3824545070001477, 0.3753566699997464]
[0.015020198999991408, 0.013106387999869185, 0.013893131000259018, 0.013064703000054578, 0.013316139999915322]
0.6433394669993504 0.041971779499817785 0.37460639074993196 0.013345090500024526




(py312) tdx@tdx-guest:~/llm_oram/nano-vllm$ python3 ttft_chunkprefill_emul.py llama3 3500
`torch_dtype` is deprecated! Use `dtype` instead!
128000
280147
128000
280147
0.6534705549993305 0.06222064999928989
1 0.38573152199933247 0.28137098899969715 0.38573152199933247
2 0.0573274609996588 1.3705999663216062e-05 0.44305898299899127
128000
280147
0.7783752969999114 0.0574770390003323
1 0.36893670100016607 0.2556988520000232 0.36893670100016607
2 0.05637380600001052 1.48110002555768e-05 0.4253105070001766
128000
280147
0.6773054329996739 0.05336949999946228
1 0.37316474599992944 0.2594402819995594 0.37316474599992944
2 0.056602659999953175 1.3674999536306132e-05 0.4297674059998826
128000
280147
0.8860779389997333 0.08395202799965773
1 0.3888083239999105 0.27394129399999656 0.3888083239999105
2 0.05564942700038955 8.55999951454578e-06 0.44445775100030005
128000
280147
0.5715706600003614 0.06320833900008438
1 0.3716128120004214 0.2628018200002771 0.3716128120004214
2 0.06317031699927611 1.0834999557118863e-05 0.4347831289996975
10143.75 1
[0.06222064999928989, 0.0574770390003323, 0.05336949999946228, 0.08395202799965773, 0.06320833900008438]
[0.44305898299899127, 0.4253105070001766, 0.4297674059998826, 0.44445775100030005, 0.4347831289996975]
[0.014735167999788246, 0.01361935499971878, 0.012626290999833145, 0.012724297000204388, 0.01275706700016599]
0.6534705549993305 0.06450172649988417 0.4335796982500142 0.012931752499980576



(py312) tdx@tdx-guest:~/llm_oram/nano-vllm$ python3 ttft_chunkprefill_emul.py llama3 4000

`torch_dtype` is deprecated! Use `dtype` instead!
128000
280147
128000
280147
0.718420082999728 0.06025794399965889
1 0.3768944610001199 0.26154701500036026 0.3768944610001199
2 0.11881790600000386 1.9409999822528334e-05 0.4957123670001238
128000
280147
0.8023830619999899 0.06713799099998141
1 0.3801693730001716 0.23679744399987612 0.3801693730001716
2 0.11782266199998048 1.5486999927816214e-05 0.4979920350001521
128000
280147
0.8457189929999913 0.06807468599981803
1 0.373679065000033 0.29080844400004935 0.373679065000033
2 0.1182804820000456 1.3542000033339718e-05 0.4919595470000786
128000
280147
0.9120866019998175 0.05919108300031439
1 0.376553961999889 0.2269223839998631 0.376553961999889
2 0.11901179300002696 1.3440000202535884e-05 0.49556575499991595
128000
280147
0.9377781629996207 0.07610986499958017
1 0.37557620500001576 0.304127865999817 0.37557620500001576
2 0.11690832300018883 1.918599991768133e-05 0.4924845280002046
11588.5 1
[0.06025794399965889, 0.06713799099998141, 0.06807468599981803, 0.05919108300031439, 0.07610986499958017]
[0.4957123670001238, 0.4979920350001521, 0.4919595470000786, 0.49556575499991595, 0.4924845280002046]
[0.014947911000035674, 0.013086875000226428, 0.013260720999824116, 0.013206225999965682, 0.01324109999995926]
0.718420082999728 0.0676284062499235 0.4945004662500878 0.013198730499993871
(py312) tdx@tdx-guest:~/llm_oram/nano-vllm$ python3 ttft_chunkprefill_emul.py llama3 4500
`torch_dtype` is deprecated! Use `dtype` instead!
128000
280147
128000
280147
0.3922975799996493 0.03541168399988237
1 0.3796399120001297 0.26639969200005 0.3796399120001297
2 0.17862798399983149 8.336999599123374e-06 0.5582678959999612
128000
280147
0.5275047400000403 0.03928519700002653
1 0.3758387299999413 0.217559288999837 0.3758387299999413
2 0.17056239000021378 7.765000191284344e-06 0.5464011200001551
128000
280147
0.4901083659997312 0.04819988400004149
1 0.37860274400009075 0.28781955200020093 0.37860274400009075
2 0.17353280300039842 2.678300006664358e-05 0.5521355470004892
128000
280147
0.5886554339999748 0.05011888899980477
1 0.37189793000015925 0.263294070000029 0.37189793000015925
2 0.17245751900009054 8.510000043315813e-06 0.5443554490002498
128000
280147
0.5685182400002304 0.06345464800006084
1 0.38249209500008874 0.29881250900007217 0.38249209500008874
2 0.1837375999998585 1.2371000138955424e-05 0.5662296949999472
13047.5 1
[0.03541168399988237, 0.03928519700002653, 0.04819988400004149, 0.05011888899980477, 0.06345464800006084]
[0.5582678959999612, 0.5464011200001551, 0.5521355470004892, 0.5443554490002498, 0.5662296949999472]
[0.015601324000272143, 0.01300497300007919, 0.013135717999830376, 0.01298867200011955, 0.013464853999721527]
0.3922975799996493 0.05026465449998341 0.5522804527502103 0.01314855424993766
(py312) tdx@tdx-guest:~/llm_oram/nano-vllm$ python3 ttft_chunkprefill_emul.py llama3 5000
`torch_dtype` is deprecated! Use `dtype` instead!
128000
280147
128000
280147
0.7176553000003878 0.05773741199982396
1 0.3835822449996158 0.3277521859999979 0.3835822449996158
2 0.2391261799998574 1.5577999874949455e-05 0.6227084249994732
128000
280147
0.6914227029997164 0.06383372599975701
1 0.3789974329997676 0.3518134310002097 0.3789974329997676
2 0.2385913719999735 1.3224000213085674e-05 0.6175888049997411
128000
280147
0.7291789229998358 0.06182880199958163
1 0.37656800600007045 0.3016445340003884 0.37656800600007045
2 0.24051868099968488 3.622799977165414e-05 0.6170866869997553
128000
280147
0.8058027319998473 0.0583331449997786
1 0.3791173180002261 0.2933691670000371 0.3791173180002261
2 0.2384660749999057 1.4258000192057807e-05 0.6175833930001318
128000
280147
0.8693639690000055 0.07212099999969723
1 0.38410245200020654 0.3489574619998166 0.38410245200020654
2 0.23943880700016962 1.3510999906429788e-05 0.6235412590003762
14498.5 1
[0.05773741199982396, 0.06383372599975701, 0.06182880199958163, 0.0583331449997786, 0.07212099999969723]
[0.6227084249994732, 0.6175888049997411, 0.6170866869997553, 0.6175833930001318, 0.6235412590003762]
[0.017091722999794, 0.013440294999782054, 0.013464088000091579, 0.01350953400014987, 0.013519853999696352]
0.7176553000003878 0.06402916824970362 0.6189500360000011 0.013483442749929964
(py312) tdx@tdx-guest:~/llm_oram/nano-vllm$ python3 ttft_chunkprefill_emul.py llama3 5500
`torch_dtype` is deprecated! Use `dtype` instead!
128000
280147
128000
280147
0.6887463240000216 0.06429946799971731
1 0.3761379749998923 0.26307960499980254 0.3761379749998923
2 0.3126365729999634 1.3890999980503693e-05 0.6887745479998557
128000
280147
0.8810577889998967 0.09351064699967537
1 0.3849644570000237 0.3299315399999614 0.3849644570000237
2 0.31257340199999817 4.896500013273908e-05 0.6975378590000219
128000
280147
0.8653626730001633 0.06643206699982329
1 0.3800143839998782 0.3147646459997304 0.3800143839998782
2 0.3128596909996304 1.4589999864256242e-05 0.6928740749995086
128000
280147
0.8304432740001175 0.07076466099988465
1 0.3778377339999679 0.36619466199999806 0.3778377339999679
2 0.3146154099999876 1.3767999917035922e-05 0.6924531439999555
128000
280147
0.9718489039996712 0.07380874699993001
1 0.3825714700001299 0.37180813099985244 0.3825714700001299
2 0.31221192200018777 1.5048000022943597e-05 0.6947833920003177
15945 1
[0.06429946799971731, 0.09351064699967537, 0.06643206699982329, 0.07076466099988465, 0.07380874699993001]
[0.6887745479998557, 0.6975378590000219, 0.6928740749995086, 0.6924531439999555, 0.6947833920003177]
[0.014740227999936906, 0.013302315000146336, 0.013207813999997597, 0.01476673800016215, 0.013320952999947622]
0.6887463240000216 0.07612903049982833 0.6944121174999509 0.013649455000063426
(py312) tdx@tdx-guest:~/llm_oram/nano-vllm$ python3 ttft_chunkprefill_emul.py llama3 6000
`torch_dtype` is deprecated! Use `dtype` instead!
128000
280147
128000
280147
0.6598857320000207 0.057125039999846194
1 0.38040223400003015 0.30977107800026715 0.38040223400003015
2 0.3782306459997926 1.2528999832284171e-05 0.7586328799998228
128000
280147
0.6866357399999288 0.06852204000006168
1 0.3750485360001221 0.1782421030002297 0.3750485360001221
2 0.3860960540000633 1.3545000001613516e-05 0.7611445900001854
128000
280147
0.7114857330002451 0.06775394900023457
1 0.37234995700009677 0.30472224700042716 0.37234995700009677
2 0.3806340090000049 1.5639000139344716e-05 0.7529839660001016
128000
280147
0.7749977489997946 0.05996179200019469
1 0.38885773799984236 0.352056704000006 0.38885773799984236
2 0.38721801300016523 1.2985000012122327e-05 0.7760757510000076
128000
280147
0.948863419999725 0.07825628399996276
1 0.37840909700025804 0.3872047269996983 0.3872047269996983
2 0.3806148070002564 4.139900011068676e-05 0.7678195339999547
17394 1
[0.057125039999846194, 0.06852204000006168, 0.06775394900023457, 0.05996179200019469, 0.07825628399996276]
[0.7586328799998228, 0.7611445900001854, 0.7529839660001016, 0.7760757510000076, 0.7678195339999547]
[0.015182592000201112, 0.013332764000097086, 0.013307572000030632, 0.013235456000074919, 0.01357356600010462]
0.6598857320000207 0.06862351625011343 0.7645059602500623 0.013362339500076814
(py312) tdx@tdx-guest:~/llm_oram/nano-vllm$ python3 ttft_chunkprefill_emul.py llama3 6500
`torch_dtype` is deprecated! Use `dtype` instead!
128000
280147
128000
280147
0.6757327589998567 0.05778853799984063
1 0.37698525899986635 0.3146172020001359 0.37698525899986635
2 0.3784477980002521 0.24951502799967784 0.7554330570001184
3 0.06688100300016231 1.1871999959112145e-05 0.8223140600002807
128000
280147
0.8437118530000589 0.07158551100019395
1 0.373340472000109 0.334127274000366 0.373340472000109
2 0.38080958499995177 0.26754040700006954 0.7541500570000608
3 0.05957000899979903 1.195699996969779e-05 0.8137200659998598
128000
280147
0.8096584909999365 0.05559414899971671
1 0.3772804380000707 0.32350131000021065 0.3772804380000707
2 0.37787011299997175 0.3063847349999378 0.7551505510000425
3 0.061598279000008915 1.1954000001423992e-05 0.8167488300000514
128000
280147
0.948791185999653 0.07353859200020452
1 0.3813737250002305 0.38396949800016955 0.38396949800016955
2 0.38098142199987706 0.2696455049999713 0.7649509200000466
3 0.06126346299970464 1.17859999591019e-05 0.8262143829997513
128000
280147
0.9319241729999703 0.08006478100014647
1 0.37162349399977757 0.38131842600023447 0.38131842600023447
2 0.3820560900003329 0.3110177040002782 0.7633745160005674
3 0.06192635599973073 1.3038999895798042e-05 0.8253008720002981
18848.75 1
[0.05778853799984063, 0.07158551100019395, 0.05559414899971671, 0.07353859200020452, 0.08006478100014647]
[0.8223140600002807, 0.8137200659998598, 0.8167488300000514, 0.8262143829997513, 0.8253008720002981]
[0.014831922999746894, 0.013702383999770973, 0.013005722999878344, 0.012819913000384986, 0.01289008300000205]
0.6757327589998567 0.07019575825006541 0.8204960377499901 0.013104525750009088
(py312) tdx@tdx-guest:~/llm_oram/nano-vllm$ python3 ttft_chunkprefill_emul.py llama3 6500
`torch_dtype` is deprecated! Use `dtype` instead!
128000
280147
128000
280147
0.6382300119998945 0.0592033520001678
1 0.37965538599974025 0.3649091799998132 0.37965538599974025
2 0.3798680949998925 0.30764473099998213 0.7595234809996327
3 0.05906750699978147 1.1813000128313433e-05 0.8185909879994142
128000
280147
0.7423268970001118 0.0667170410001745
1 0.368179912999949 0.3642610849997254 0.368179912999949
2 0.3789622760000384 0.29203149300019504 0.7471421889999874
3 0.0594357840000157 1.1919999906240264e-05 0.8065779730000031
128000
280147
0.8118862149999586 0.09556513899997299
1 0.37570968399995763 0.375091655000233 0.37570968399995763
2 0.3784278059997632 0.23530360799986738 0.7541374899997209
3 0.08540955199987366 1.1642000117717544e-05 0.8395470419995945
128000
280147
0.8073068809999313 0.06410642900027597
1 0.3837129889998323 0.38195227699998213 0.3837129889998323
2 0.379636680999738 0.3086264490002577 0.7633496699995703
3 0.060070178999922064 1.2840000181313371e-05 0.8234198489994924
128000
280147
0.8616666439997971 0.07539726999993945
1 0.37211237800011077 0.3659912749999421 0.37211237800011077
2 0.3838083910000023 0.31372017700005017 0.7559207690001131
3 0.06179528800021217 1.3546999980462715e-05 0.8177160570003252
18848.75 1
[0.0592033520001678, 0.0667170410001745, 0.09556513899997299, 0.06410642900027597, 0.07539726999993945]
[0.8185909879994142, 0.8065779730000031, 0.8395470419995945, 0.8234198489994924, 0.8177160570003252]
[0.015795401000104903, 0.012981418999970629, 0.012701836999895022, 0.013067486999716493, 0.012893614999939018]
0.6382300119998945 0.07544646975009073 0.8218152302498538 0.01291108949988029
